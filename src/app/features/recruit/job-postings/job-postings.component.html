<div class="job-postings-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Job Postings</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- Search and Filters -->
      <div class="search-filters">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search</mat-label>
          <input matInput [(ngModel)]="searchTerm" (ngModelChange)="onSearch()" placeholder="Search by job title, code...">
          <mat-icon matPrefix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Department</mat-label>
          <mat-select [(ngModel)]="selectedDepartment" (selectionChange)="onFilterChange()">
            <mat-option value="">All Departments</mat-option>
            <mat-option *ngFor="let dept of departments" [value]="dept">
              {{ dept }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="selectedStatus" (selectionChange)="onFilterChange()">
            <mat-option *ngFor="let status of statuses" [value]="status.value">
              {{ status.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Employment Type</mat-label>
          <mat-select [(ngModel)]="selectedEmploymentType" (selectionChange)="onFilterChange()">
            <mat-option *ngFor="let type of employmentTypes" [value]="type.value">
              {{ type.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Job Postings List -->
      <div *ngIf="loading; else jobList" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>

      <ng-template #jobList>
        <div class="jobs-grid" *ngIf="filteredJobPostings.length > 0; else noJobs">
          <mat-card class="job-card" *ngFor="let job of filteredJobPostings">
            <mat-card-header>
              <mat-card-title>{{ job.jobTitle }}</mat-card-title>
              <mat-card-subtitle>{{ job.jobCode }}</mat-card-subtitle>
              <div class="card-actions">
                <mat-chip [color]="getStatusColor(job.status)">
                  {{ getStatusLabel(job.status) }}
                </mat-chip>
              </div>
            </mat-card-header>
            <mat-card-content>
              <div class="job-info">
                <div class="info-item" *ngIf="job.positionName">
                  <mat-icon>work</mat-icon>
                  <span>{{ job.positionName }}</span>
                </div>
                <div class="info-item" *ngIf="job.department">
                  <mat-icon>business</mat-icon>
                  <span>{{ job.department }}</span>
                </div>
                <div class="info-item" *ngIf="job.location">
                  <mat-icon>location_on</mat-icon>
                  <span>{{ job.location }}</span>
                </div>
                <div class="info-item" *ngIf="job.employmentType">
                  <mat-icon>schedule</mat-icon>
                  <span>{{ job.employmentType }}</span>
                </div>
                <div class="info-item" *ngIf="job.salaryFrom || job.salaryTo">
                  <mat-icon>attach_money</mat-icon>
                  <span>
                    <span *ngIf="job.salaryFrom">{{ job.salaryFrom | number:'1.0-0' }}</span>
                    <span *ngIf="job.salaryFrom && job.salaryTo"> - </span>
                    <span *ngIf="job.salaryTo">{{ job.salaryTo | number:'1.0-0' }}</span>
                    <span *ngIf="job.salaryFrom || job.salaryTo"> à¸¿</span>
                  </span>
                </div>
                <div class="info-item" *ngIf="job.closingDate">
                  <mat-icon>event</mat-icon>
                  <span>Closes: {{ job.closingDate | dateFormat:'short' }}</span>
                </div>
              </div>
              <p class="description" *ngIf="job.description">
                {{ job.description }}
              </p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button (click)="viewJobDetails(job)">
                <mat-icon>info</mat-icon>
                View Details
              </button>
              <button 
                mat-raised-button 
                color="primary" 
                (click)="applyForJob(job)"
                *ngIf="isJobOpen(job)">
                <mat-icon>send</mat-icon>
                Apply Now
              </button>
            </mat-card-actions>
          </mat-card>
        </div>

        <ng-template #noJobs>
          <div class="no-data">
            <mat-icon>work_off</mat-icon>
            <p>No job postings found. Try adjusting your filters.</p>
          </div>
        </ng-template>
      </ng-template>
    </mat-card-content>
  </mat-card>
</div>

