<div class="interview-scheduling-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Interview Scheduling</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-tab-group [(selectedIndex)]="activeTab">
        <mat-tab label="Schedule Interview">
          <div class="tab-content">
            <form [formGroup]="interviewForm" (ngSubmit)="submitInterview()">
              <div class="form-content">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Application</mat-label>
                  <mat-select formControlName="applicationId" [disabled]="!!applicationId">
                    <mat-option *ngFor="let app of applications" [value]="app.applicationId">
                      {{ app.jobTitle }} - {{ app.applicantName }}
                    </mat-option>
                  </mat-select>
                  <mat-icon matPrefix>description</mat-icon>
                  <mat-error *ngIf="interviewForm.get('applicationId')?.hasError('required')">
                    Application is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Interview Type</mat-label>
                  <mat-select formControlName="interviewType">
                    <mat-option *ngFor="let type of interviewTypes" [value]="type.value">
                      {{ type.label }}
                    </mat-option>
                  </mat-select>
                  <mat-icon matPrefix>event</mat-icon>
                  <mat-error *ngIf="interviewForm.get('interviewType')?.hasError('required')">
                    Interview type is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Interview Date</mat-label>
                  <input matInput [matDatepicker]="datePicker" formControlName="interviewDate">
                  <mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
                  <mat-datepicker #datePicker></mat-datepicker>
                  <mat-icon matPrefix>calendar_today</mat-icon>
                  <mat-error *ngIf="interviewForm.get('interviewDate')?.hasError('required')">
                    Interview date is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Interview Time</mat-label>
                  <input matInput type="time" formControlName="interviewTime">
                  <mat-icon matPrefix>schedule</mat-icon>
                  <mat-error *ngIf="interviewForm.get('interviewTime')?.hasError('required')">
                    Interview time is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Location</mat-label>
                  <input matInput formControlName="location" placeholder="Optional">
                  <mat-icon matPrefix>location_on</mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Interviewer ID</mat-label>
                  <input matInput formControlName="interviewerId" placeholder="Optional">
                  <mat-icon matPrefix>person</mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Notes</mat-label>
                  <textarea matInput formControlName="notes" rows="4" placeholder="Optional notes"></textarea>
                  <mat-icon matPrefix>notes</mat-icon>
                </mat-form-field>
              </div>

              <div class="form-actions">
                <button mat-button type="button" (click)="interviewForm.reset()">
                  Reset
                </button>
                <button
                  mat-raised-button
                  color="primary"
                  type="submit"
                  [disabled]="loading || interviewForm.invalid">
                  <mat-spinner diameter="20" *ngIf="loading" class="inline-spinner"></mat-spinner>
                  <span *ngIf="!loading">Schedule Interview</span>
                  <span *ngIf="loading">Scheduling...</span>
                </button>
              </div>
            </form>
          </div>
        </mat-tab>

        <mat-tab label="Scheduled Interviews">
          <div class="tab-content">
            <div *ngIf="loading; else interviewsContent" class="loading-container">
              <mat-spinner></mat-spinner>
            </div>

            <ng-template #interviewsContent>
              <div class="interviews-list" *ngIf="interviews.length > 0; else noInterviews">
                <div class="interview-item" *ngFor="let interview of interviews">
                  <mat-card>
                    <mat-card-header>
                      <mat-card-title>{{ interview.candidateName || 'N/A' }}</mat-card-title>
                      <mat-card-subtitle>{{ interview.jobTitle || 'N/A' }}</mat-card-subtitle>
                      <div class="interview-status">
                        <mat-chip [color]="getStatusColor(interview.status)">
                          {{ interview.status }}
                        </mat-chip>
                      </div>
                    </mat-card-header>
                    <mat-card-content>
                      <div class="interview-info">
                        <div class="info-item">
                          <span class="label">Interview Type:</span>
                          <span>{{ getInterviewTypeLabel(interview.interviewType) }}</span>
                        </div>
                        <div class="info-item">
                          <span class="label">Date:</span>
                          <span>{{ interview.interviewDate | dateFormat:'long' }}</span>
                        </div>
                        <div class="info-item">
                          <span class="label">Time:</span>
                          <span>{{ interview.interviewTime }}</span>
                        </div>
                        <div class="info-item" *ngIf="interview.location">
                          <span class="label">Location:</span>
                          <span>{{ interview.location }}</span>
                        </div>
                        <div class="info-item" *ngIf="interview.interviewerName">
                          <span class="label">Interviewer:</span>
                          <span>{{ interview.interviewerName }}</span>
                        </div>
                        <div class="info-item" *ngIf="interview.notes">
                          <span class="label">Notes:</span>
                          <span>{{ interview.notes }}</span>
                        </div>
                      </div>
                    </mat-card-content>
                    <mat-card-actions>
                      <button 
                        mat-button 
                        color="warn" 
                        (click)="cancelInterview(interview)"
                        *ngIf="interview.status === 'scheduled'">
                        <mat-icon>cancel</mat-icon>
                        Cancel
                      </button>
                    </mat-card-actions>
                  </mat-card>
                </div>
              </div>

              <ng-template #noInterviews>
                <div class="no-data">
                  <mat-icon>event_busy</mat-icon>
                  <p>No interviews scheduled</p>
                </div>
              </ng-template>
            </ng-template>
          </div>
        </mat-tab>
      </mat-tab-group>
    </mat-card-content>
  </mat-card>
</div>

