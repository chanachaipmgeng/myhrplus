<div class="training-catalog-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Training Catalog</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- Search and Filters -->
      <div class="search-filters">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search</mat-label>
          <input matInput [(ngModel)]="searchTerm" (ngModelChange)="onSearch()" placeholder="Search by course name, title...">
          <mat-icon matPrefix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Category</mat-label>
          <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onFilterChange()">
            <mat-option value="">All Categories</mat-option>
            <mat-option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="selectedStatus" (selectionChange)="onFilterChange()">
            <mat-option *ngFor="let status of statuses" [value]="status.value">
              {{ status.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Date Range</mat-label>
          <mat-select [(ngModel)]="selectedDateRange" (selectionChange)="onFilterChange()">
            <mat-option *ngFor="let range of dateRanges" [value]="range.value">
              {{ range.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Training List -->
      <div *ngIf="loading; else trainingList" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>

      <ng-template #trainingList>
        <div class="trainings-grid" *ngIf="filteredTrainings.length > 0; else noTrainings">
          <mat-card class="training-card" *ngFor="let training of filteredTrainings">
            <mat-card-header>
              <mat-card-title>{{ training.courseName }}</mat-card-title>
              <mat-card-subtitle>{{ training.title }}</mat-card-subtitle>
              <div class="card-actions">
                <mat-chip [color]="getStatusColor(training.status)">
                  {{ getStatusLabel(training.status) }}
                </mat-chip>
              </div>
            </mat-card-header>
            <mat-card-content>
              <div class="training-info">
                <div class="info-item" *ngIf="training.startDate">
                  <mat-icon>calendar_today</mat-icon>
                  <span>{{ training.startDate | dateFormat:'short' }} - {{ training.endDate | dateFormat:'short' }}</span>
                </div>
                <div class="info-item" *ngIf="training.location">
                  <mat-icon>location_on</mat-icon>
                  <span>{{ training.location }}</span>
                </div>
                <div class="info-item" *ngIf="training.instructor">
                  <mat-icon>person</mat-icon>
                  <span>{{ training.instructor }}</span>
                </div>
                <div class="info-item" *ngIf="training.hours">
                  <mat-icon>schedule</mat-icon>
                  <span>{{ training.hours }} hours</span>
                </div>
                <div class="info-item" *ngIf="training.maxParticipants">
                  <mat-icon>people</mat-icon>
                  <span>{{ training.currentParticipants || 0 }} / {{ training.maxParticipants }} participants</span>
                </div>
              </div>
              <p class="description" *ngIf="training.description">
                {{ training.description }}
              </p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button (click)="viewTrainingDetails(training)">
                <mat-icon>info</mat-icon>
                View Details
              </button>
              <button 
                mat-raised-button 
                color="primary" 
                (click)="registerForTraining(training)"
                *ngIf="isRegistrationOpen(training)">
                <mat-icon>how_to_reg</mat-icon>
                Register
              </button>
            </mat-card-actions>
          </mat-card>
        </div>

        <ng-template #noTrainings>
          <div class="no-data">
            <mat-icon>school</mat-icon>
            <p>No trainings found. Try adjusting your filters.</p>
          </div>
        </ng-template>
      </ng-template>
    </mat-card-content>
  </mat-card>
</div>

