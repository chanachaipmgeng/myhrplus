<div class="training-registration-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Training Registration</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-tab-group [(selectedIndex)]="activeTab">
        <mat-tab label="Register for Training">
          <div class="tab-content">
            <div *ngIf="training" class="training-preview">
              <h3>{{ training.courseName }}</h3>
              <p>{{ training.title }}</p>
              <div class="training-meta">
                <span *ngIf="training.startDate">
                  <mat-icon>calendar_today</mat-icon>
                  {{ training.startDate | dateFormat:'short' }} - {{ training.endDate | dateFormat:'short' }}
                </span>
                <span *ngIf="training.location">
                  <mat-icon>location_on</mat-icon>
                  {{ training.location }}
                </span>
              </div>
            </div>

            <form [formGroup]="registrationForm" (ngSubmit)="submitRegistration()">
              <div class="form-content">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Remarks</mat-label>
                  <textarea matInput formControlName="remarks" rows="4" placeholder="Optional remarks"></textarea>
                  <mat-icon matPrefix>notes</mat-icon>
                </mat-form-field>
              </div>

              <div class="form-actions">
                <button mat-button type="button" (click)="navigateToCatalog()">
                  Cancel
                </button>
                <button
                  mat-raised-button
                  color="primary"
                  type="submit"
                  [disabled]="loading || registrationForm.invalid">
                  <mat-spinner diameter="20" *ngIf="loading" class="inline-spinner"></mat-spinner>
                  <span *ngIf="!loading">Register</span>
                  <span *ngIf="loading">Registering...</span>
                </button>
              </div>
            </form>
          </div>
        </mat-tab>

        <mat-tab label="My Registrations">
          <div class="tab-content">
            <div *ngIf="loading; else registrationsContent" class="loading-container">
              <mat-spinner></mat-spinner>
            </div>

            <ng-template #registrationsContent>
              <div class="registrations-list" *ngIf="myRegistrations.length > 0; else noRegistrations">
                <div class="registration-item" *ngFor="let registration of myRegistrations">
                  <div class="registration-info">
                    <div class="info-item">
                      <span class="label">Training ID:</span>
                      <span>{{ registration.trainingId }}</span>
                    </div>
                    <div class="info-item">
                      <span class="label">Registration Date:</span>
                      <span>{{ registration.registrationDate | dateFormat:'short' }}</span>
                    </div>
                    <div class="info-item">
                      <span class="label">Status:</span>
                      <mat-chip [color]="getStatusColor(registration.status)">
                        {{ registration.status }}
                      </mat-chip>
                    </div>
                    <div class="info-item" *ngIf="registration.remarks">
                      <span class="label">Remarks:</span>
                      <span>{{ registration.remarks }}</span>
                    </div>
                  </div>
                  <div class="registration-actions">
                    <button mat-button color="warn" (click)="cancelRegistration(registration)" *ngIf="registration.status === 'pending' || registration.status === 'confirmed'">
                      <mat-icon>cancel</mat-icon>
                      Cancel
                    </button>
                  </div>
                </div>
              </div>

              <ng-template #noRegistrations>
                <div class="no-data">
                  <mat-icon>event_busy</mat-icon>
                  <p>No registrations found</p>
                </div>
              </ng-template>
            </ng-template>
          </div>
        </mat-tab>
      </mat-tab-group>
    </mat-card-content>
  </mat-card>
</div>

