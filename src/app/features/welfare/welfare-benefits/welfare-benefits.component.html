<div class="welfare-benefits-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Welfare Benefits</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- Search and Filters -->
      <div class="search-filters">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search</mat-label>
          <input matInput [(ngModel)]="searchTerm" (ngModelChange)="onSearch()" placeholder="Search by benefit name, code...">
          <mat-icon matPrefix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Category</mat-label>
          <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onFilterChange()">
            <mat-option value="">All Categories</mat-option>
            <mat-option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="selectedStatus" (selectionChange)="onFilterChange()">
            <mat-option *ngFor="let status of statuses" [value]="status.value">
              {{ status.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Benefits List -->
      <div *ngIf="loading; else benefitsList" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>

      <ng-template #benefitsList>
        <div class="benefits-grid" *ngIf="filteredBenefits.length > 0; else noBenefits">
          <mat-card class="benefit-card" *ngFor="let benefit of filteredBenefits">
            <mat-card-header>
              <mat-card-title>{{ benefit.benefitName }}</mat-card-title>
              <mat-card-subtitle>{{ benefit.benefitCode }}</mat-card-subtitle>
              <div class="card-actions">
                <mat-chip [color]="getStatusColor(benefit.status)">
                  {{ getStatusLabel(benefit.status) }}
                </mat-chip>
              </div>
            </mat-card-header>
            <mat-card-content>
              <div class="benefit-info">
                <div class="info-item" *ngIf="benefit.category">
                  <mat-icon>category</mat-icon>
                  <span>{{ benefit.category }}</span>
                </div>
                <div class="info-item" *ngIf="benefit.cost">
                  <mat-icon>attach_money</mat-icon>
                  <span>{{ benefit.cost | number:'1.2-2' }} à¸¿</span>
                </div>
                <div class="info-item" *ngIf="benefit.quantity">
                  <mat-icon>inventory</mat-icon>
                  <span>Quantity: {{ benefit.quantity }}</span>
                </div>
                <div class="info-item" *ngIf="benefit.enrollmentStartDate">
                  <mat-icon>event</mat-icon>
                  <span>Enrollment: {{ benefit.enrollmentStartDate | dateFormat:'short' }} - {{ benefit.enrollmentEndDate | dateFormat:'short' }}</span>
                </div>
              </div>
              <p class="description" *ngIf="benefit.description">
                {{ benefit.description }}
              </p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button (click)="viewBenefitDetails(benefit)">
                <mat-icon>info</mat-icon>
                View Details
              </button>
              <button 
                mat-raised-button 
                color="primary" 
                (click)="enrollInBenefit(benefit)"
                *ngIf="isEnrollmentOpen(benefit)">
                <mat-icon>how_to_reg</mat-icon>
                Enroll
              </button>
            </mat-card-actions>
          </mat-card>
        </div>

        <ng-template #noBenefits>
          <div class="no-data">
            <mat-icon>card_giftcard</mat-icon>
            <p>No benefits found. Try adjusting your filters.</p>
          </div>
        </ng-template>
      </ng-template>
    </mat-card-content>
  </mat-card>
</div>

