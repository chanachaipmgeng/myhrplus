<app-page-layout
  title="Employee Work Information"
  description="à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸žà¸™à¸±à¸à¸‡à¸²à¸™"
  icon="ðŸ’¼">
  
  <app-glass-card padding="p-6" [animate]="'fade-in'">
    <app-loading *ngIf="loading" message="à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥..."></app-loading>

    <div *ngIf="!loading">
      <!-- Profile Header -->
      <div class="profile-header mb-6" *ngIf="profileData">
        <div class="profile-picture-section">
          <img [src]="getPictureUrl()" [alt]="getFullname()" class="profile-picture w-24 h-24 rounded-full object-cover">
        </div>
        <div class="profile-info-section">
          <h2 class="profile-name text-xl font-semibold text-slate-800 dark:text-slate-100 thai-text">{{ getFullname() }}</h2>
          <div class="profile-details grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div class="detail-item">
              <span class="detail-label text-sm text-slate-600 dark:text-slate-400">Employee ID:</span>
              <span class="detail-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ profileData.employeeId }}</span>
            </div>
            <div class="detail-item" *ngIf="profileData.position">
              <span class="detail-label text-sm text-slate-600 dark:text-slate-400">Position:</span>
              <span class="detail-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ profileData.position?.tdesc || profileData.position?.edesc || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="profileData.email">
              <span class="detail-label text-sm text-slate-600 dark:text-slate-400">E-Mail:</span>
              <span class="detail-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ profileData.email }}</span>
            </div>
            <div class="detail-item" *ngIf="empWork && empWork['telExt']">
              <span class="detail-label text-sm text-slate-600 dark:text-slate-400">Internal Number:</span>
              <span class="detail-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['telExt'] }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs-container">
        <div class="tabs-header flex border-b border-gray-200 dark:border-gray-700 mb-4">
          <button
            (click)="activeTab = 0"
            [class.active]="activeTab === 0"
            class="px-6 py-3 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 border-b-2 transition-colors"
            [class.border-indigo-600]="activeTab === 0"
            [class.text-indigo-600]="activeTab === 0"
            [class.dark:text-indigo-400]="activeTab === 0">
            Work Information
          </button>
          <button
            *ngIf="empMove && empMove.length > 0"
            (click)="activeTab = 1"
            [class.active]="activeTab === 1"
            class="px-6 py-3 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 border-b-2 transition-colors"
            [class.border-indigo-600]="activeTab === 1"
            [class.text-indigo-600]="activeTab === 1"
            [class.dark:text-indigo-400]="activeTab === 1">
            Movements
          </button>
        </div>

        <div class="tabs-content">
          <!-- Work Information Tab -->
          <div *ngIf="activeTab === 0" class="tab-content">
            <div class="info-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" *ngIf="empWork">
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Job Title:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['job']?.tdesc || empWork['job']?.edesc || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="!empId">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">PL ID:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['pl']?.plId || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="!empId">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Head Employee ID:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bossId'] || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="!empId">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Employee Group:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['group']?.tdesc || empWork['group']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Position:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['position']?.tdesc || empWork['position']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">BU1:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bu1']?.tdesc || empWork['bu1']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">BU2:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bu2']?.tdesc || empWork['bu2']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">BU3:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bu3']?.tdesc || empWork['bu3']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">BU4:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bu4']?.tdesc || empWork['bu4']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">BU5:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['bu5']?.tdesc || empWork['bu5']?.edesc || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="!empId">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Branch:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['branch']?.tdesc || empWork['branch']?.edesc || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="!empId">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Work Place:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['workarea']?.tdesc || empWork['workarea']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Type Employee:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['type']?.tdesc || empWork['type']?.edesc || '-' }}</span>
              </div>
              <div class="info-item">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Shift:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork['shift']?.tdesc || empWork['shift']?.edesc || '-' }}</span>
              </div>
              <div class="info-item" *ngIf="empWork.firstHiredate">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">First Hire Date:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ empWork.firstHiredate | date:'dd-MM-yyyy' }}</span>
              </div>
              <div class="info-item" *ngIf="empWork.firstHiredate">
                <label class="info-label text-sm text-slate-600 dark:text-slate-400">Working Period:</label>
                <span class="info-value text-sm font-medium text-slate-800 dark:text-slate-100">{{ yearGenerate() }} à¸›à¸µ {{ monthGenerate() }} à¹€à¸”à¸·à¸­à¸™ {{ dateGenerate() }} à¸§à¸±à¸™</span>
              </div>
            </div>
          </div>

          <!-- Movements Tab -->
          <div *ngIf="activeTab === 1 && empMove && empMove.length > 0" class="tab-content">
            <div class="overflow-x-auto">
              <table class="w-full border-collapse">
                <thead class="bg-gray-50 dark:bg-gray-900">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider thai-text">Effective Date</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider thai-text">Adjustment Type</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider thai-text">Position</th>
                  </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                  <tr *ngFor="let move of empMove" class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-100">{{ move.eff_date | date:'dd-MM-yyyy' }}</td>
                    <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-100">{{ move['adj_type'] || '-' }}</td>
                    <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-100">{{ move['emp_position']?.tdesc || move['emp_position']?.edesc || '-' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-glass-card>
</app-page-layout>
