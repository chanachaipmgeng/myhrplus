<div class="ta-reports-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Time Attendance Reports</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-tab-group [(selectedIndex)]="activeTab">
        <mat-tab label="Leave Report">
          <div class="tab-content">
            <div class="report-filters">
              <mat-form-field appearance="outline">
                <mat-label>Start Date</mat-label>
                <input matInput [matDatepicker]="leaveStartPicker" [(ngModel)]="leaveReportParams.startDate">
                <mat-datepicker-toggle matSuffix [for]="leaveStartPicker"></mat-datepicker-toggle>
                <mat-datepicker #leaveStartPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>End Date</mat-label>
                <input matInput [matDatepicker]="leaveEndPicker" [(ngModel)]="leaveReportParams.endDate">
                <mat-datepicker-toggle matSuffix [for]="leaveEndPicker"></mat-datepicker-toggle>
                <mat-datepicker #leaveEndPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Employee ID</mat-label>
                <input matInput [(ngModel)]="leaveReportParams.employeeId" placeholder="Optional">
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Leave Type</mat-label>
                <input matInput [(ngModel)]="leaveReportParams.leaveType" placeholder="Optional">
              </mat-form-field>

              <button mat-raised-button color="primary" (click)="loadLeaveReport()" [disabled]="loading">
                <mat-icon>search</mat-icon>
                Search
              </button>

              <button mat-button (click)="exportReport('leave')" [disabled]="leaveReportData.length === 0">
                <mat-icon>download</mat-icon>
                Export
              </button>
            </div>

            <div *ngIf="loading; else leaveReportContent" class="loading-container">
              <mat-spinner></mat-spinner>
            </div>

            <ng-template #leaveReportContent>
              <div class="report-table" *ngIf="leaveReportData.length > 0; else noLeaveData">
                <app-data-table
                  [columns]="leaveReportColumns"
                  [data]="leaveReportData"
                  [pageSize]="20">
                </app-data-table>
              </div>

              <ng-template #noLeaveData>
                <div class="no-data">
                  <mat-icon>description</mat-icon>
                  <p>No leave report data. Please search with filters.</p>
                </div>
              </ng-template>
            </ng-template>
          </div>
        </mat-tab>

        <mat-tab label="Overtime Report">
          <div class="tab-content">
            <div class="report-filters">
              <mat-form-field appearance="outline">
                <mat-label>Start Date</mat-label>
                <input matInput [matDatepicker]="otStartPicker" [(ngModel)]="overtimeReportParams.startDate">
                <mat-datepicker-toggle matSuffix [for]="otStartPicker"></mat-datepicker-toggle>
                <mat-datepicker #otStartPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>End Date</mat-label>
                <input matInput [matDatepicker]="otEndPicker" [(ngModel)]="overtimeReportParams.endDate">
                <mat-datepicker-toggle matSuffix [for]="otEndPicker"></mat-datepicker-toggle>
                <mat-datepicker #otEndPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Employee ID</mat-label>
                <input matInput [(ngModel)]="overtimeReportParams.employeeId" placeholder="Optional">
              </mat-form-field>

              <button mat-raised-button color="primary" (click)="loadOvertimeReport()" [disabled]="loading">
                <mat-icon>search</mat-icon>
                Search
              </button>

              <button mat-button (click)="exportReport('overtime')" [disabled]="overtimeReportData.length === 0">
                <mat-icon>download</mat-icon>
                Export
              </button>
            </div>

            <div *ngIf="loading; else overtimeReportContent" class="loading-container">
              <mat-spinner></mat-spinner>
            </div>

            <ng-template #overtimeReportContent>
              <div class="report-table" *ngIf="overtimeReportData.length > 0; else noOvertimeData">
                <app-data-table
                  [columns]="overtimeReportColumns"
                  [data]="overtimeReportData"
                  [pageSize]="20">
                </app-data-table>
              </div>

              <ng-template #noOvertimeData>
                <div class="no-data">
                  <mat-icon>description</mat-icon>
                  <p>No overtime report data. Please search with filters.</p>
                </div>
              </ng-template>
            </ng-template>
          </div>
        </mat-tab>

        <mat-tab label="Attendance Report">
          <div class="tab-content">
            <div class="report-filters">
              <mat-form-field appearance="outline">
                <mat-label>Start Date</mat-label>
                <input matInput [matDatepicker]="attStartPicker" [(ngModel)]="attendanceReportParams.startDate">
                <mat-datepicker-toggle matSuffix [for]="attStartPicker"></mat-datepicker-toggle>
                <mat-datepicker #attStartPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>End Date</mat-label>
                <input matInput [matDatepicker]="attEndPicker" [(ngModel)]="attendanceReportParams.endDate">
                <mat-datepicker-toggle matSuffix [for]="attEndPicker"></mat-datepicker-toggle>
                <mat-datepicker #attEndPicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Employee ID</mat-label>
                <input matInput [(ngModel)]="attendanceReportParams.employeeId" placeholder="Optional">
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Department</mat-label>
                <input matInput [(ngModel)]="attendanceReportParams.department" placeholder="Optional">
              </mat-form-field>

              <button mat-raised-button color="primary" (click)="loadAttendanceReport()" [disabled]="loading">
                <mat-icon>search</mat-icon>
                Search
              </button>

              <button mat-button (click)="exportReport('attendance')" [disabled]="attendanceReportData.length === 0">
                <mat-icon>download</mat-icon>
                Export
              </button>
            </div>

            <div *ngIf="loading; else attendanceReportContent" class="loading-container">
              <mat-spinner></mat-spinner>
            </div>

            <ng-template #attendanceReportContent>
              <div class="report-table" *ngIf="attendanceReportData.length > 0; else noAttendanceData">
                <app-data-table
                  [columns]="attendanceReportColumns"
                  [data]="attendanceReportData"
                  [pageSize]="20">
                </app-data-table>
              </div>

              <ng-template #noAttendanceData>
                <div class="no-data">
                  <mat-icon>description</mat-icon>
                  <p>No attendance report data. Please search with filters.</p>
                </div>
              </ng-template>
            </ng-template>
          </div>
        </mat-tab>
      </mat-tab-group>
    </mat-card-content>
  </mat-card>
</div>

