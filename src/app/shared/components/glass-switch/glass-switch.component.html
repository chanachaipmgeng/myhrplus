<div class="flex items-start gap-3">
  <!-- Switch Track -->
  <button
    type="button"
    [id]="switchId"
    role="switch"
    [disabled]="disabled"
    [attr.aria-label]="ariaLabel || label"
    [attr.aria-describedby]="describedByIds || null"
    [attr.aria-invalid]="hasError"
    [attr.aria-required]="required"
    [attr.aria-checked]="checked"
    (click)="toggle()"
    (blur)="onBlur()"
    (keydown.enter)="toggle()"
    (keydown.space)="toggle(); $event.preventDefault()"
    [class]="sizeClasses.track"
    class="flex-shrink-0 rounded-full border-2 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 relative"
    [ngClass]="{
      'glass border-gray-300 dark:border-gray-600 theme-gemini:border-white/30 dark:glass-dark theme-gemini:glass-gemini': !checked && !hasError,
      'bg-primary-500 border-primary-500 dark:bg-primary-600 dark:border-primary-600 theme-gemini:bg-blue-500 theme-gemini:border-blue-500 focus:ring-primary-500 dark:focus:ring-primary-600 theme-gemini:focus:ring-blue-500': checked && !hasError,
      'border-red-500 dark:border-red-400 theme-gemini:border-red-400 focus:ring-red-500 dark:focus:ring-red-400 theme-gemini:focus:ring-red-400 animate-shake': hasError
    }">
    <!-- Switch Thumb -->
    <span
      [class]="sizeClasses.thumb"
      class="absolute top-0.5 left-0.5 rounded-full bg-white dark:bg-gray-100 theme-gemini:bg-white shadow-md transition-all duration-300 transform"
      [ngClass]="{
        'translate-x-0': !checked,
        'translate-x-full': checked && size === 'sm',
        'translate-x-5': checked && size === 'md',
        'translate-x-7': checked && size === 'lg'
      }">
    </span>
  </button>

  <!-- Label -->
  <div class="flex-1 min-w-0">
    <label
      [for]="switchId"
      (click)="toggle()"
      class="block text-sm font-medium text-gray-700 dark:text-gray-200 theme-gemini:text-white/90 cursor-pointer select-none"
      [ngClass]="{
        'cursor-not-allowed opacity-50': disabled,
        'text-red-500 dark:text-red-400 theme-gemini:text-red-400': hasError
      }">
      {{ label }}
      <span *ngIf="required" class="text-red-500 dark:text-red-400 theme-gemini:text-red-400 ml-1" aria-label="จำเป็น">*</span>
    </label>

    <!-- Hint Message -->
    <div *ngIf="hint && !hasError" 
         [id]="hintId" 
         class="text-gray-500 dark:text-gray-400 theme-gemini:text-white/60 text-xs mt-1">
      {{ hint }}
    </div>

    <!-- Error Message -->
    <div *ngIf="hasError && errorMessage" 
         [id]="errorMessageId" 
         role="alert" 
         class="flex items-center gap-1.5 text-red-500 dark:text-red-400 theme-gemini:text-red-400 text-sm mt-1 animate-fade-in" 
         aria-live="polite">
      <app-icon name="error" size="xs" color="text-red-500 dark:text-red-400 theme-gemini:text-red-400"></app-icon>
      <span class="thai-text">{{ errorMessage }}</span>
    </div>
  </div>
</div>

